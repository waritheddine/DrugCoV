# DrugCoV
Discovering New Drug-Target Interactions for the COVID-19 Through Knowledge Graph Embedding.

Authors: Warith Eddine DJEDDI and Sadok BEN YAHIA

Email: waritheddine.jeddi@isikef.u-jendouba.tn
# Quick start
To reproduce our results:
1. Untar the file "DrugCoV-master.tar.xz"
2. Run <code>DrugCoV.py</code> to reproduce the cross validation results of DrugCoV and predict drug-target interaction using a given classifier (e.g., MLPC, GAUSSIAN-NB, Decision tree).
# Data description
The whole dataset contains five part:
- dglke.tsv, a tsv file containing the knowledge graph in the format of (h, r, t) triplets (which can be downloaded from this link:
https://drive.google.com/file/d/1KfoscGS99OZOtP6WEoBiFTT3nggERT_e/view?usp=sharing

- folder containing the pretrained Knowledge Graph Embedding using the entire dglke.tsv using the DGLKE methods: The embedding file is trained using Distmult model that utilizes the $cosinus$ distance. It is worthy of mention, that the pretrained Knowledge Graph Embedding can be obtained by following these steps:
  a) Execute the python file "Train-dglke.py" in order to split the dile to "dglke.tsv" file in training, validation and testing data.
  b) Execute this command in order to generate the four files:
```
DGLBACKEND=pytorch dglke_train --dataset DGLKE --model_name DistMult --batch_size 2000 --neg_sample_size 1500 --hidden_dim 1800 --gamma 19.9 --lr 0.25 --max_step 300000 --log_interval 100 --batch_size_eval 16 -adv --regularization_coef 1.00E-09 --test --data_path ./train/ --format raw_udd_hrt --data_files dglke_train.tsv dglke_valid.tsv dglke_test.tsv --neg_sample_size_eval 10000
```
there are four generated files:
     1) DGLKE_DistMult_entity.npy, NumPy binary data, storing the entity embedding
     2) DGLKE_DistMult_relation.npy, NumPy binary data, storing the relation embedding
     3) entities.tsv, mapping from entity_name to entity_id.
     4) relations.tsv, mapping from relation_name to relation_id
   To use the pretrained embedding, one can use np.load to load the entity embeddings and relation embeddings separately:

```
import numpy as np
entity_dglke_emb = np.load('./data/ckpts/DGLKE_DistMult_entity.npy')
relation_dglke_emb = np.load('./data/ckpts/DGLKE_DistMult_relation.npy')
```
- Execute the "DGLKE_predictFunction.py" file in order to find the potential proposed drugs related to the coronavirus.

- Execute this command in order to generating the embedding similarities between the source and target file using the cosinus metric:  
```
dglke_predict --model_path ckpts/DistMult_DGLKE_1/ --format 'h_*_t' --data_files train/head.list train/rel.list --score_func logsigmoid --topK 5 --exec_mode 'batch_rel'
```
- Execute the file "Converting2DMatrices.py" in order to convert the embedding similarities file (Generated by the below command) to a given matrix.
     
- The Gene and Drugs matrices:
* DrugIdsCov_index.txt: list of drug names.
* GenesIdsCov_index.txt: list of gene names.
* Drug_Diseases_Similarity_Matrix.txt : Drug-disease similarities matrix.
* Drug_Gene_Similarity_Matrix.txt : Drug-gene similarities matrix.
* Drug_GOID_similarity.txt : Drug-gene ontology terms similarities matrix.
* Drug_Proteins_Similarity_Matrix.txt : Drug-proteins similarities matrix.
* Drug_SideEffect_Similarity_Matrix.txt : Drug-Side Effects similarities matrix.
* Gene_GOID_Sim_mini_Matrix.txt : Gene-gene ontology terms similarities matrix.
* GeneDiseases_Similarity_Matrix.txt : Gene-disease similarities matrix.
* Gene_Gene_Interaction_Matrix.txt : Gene-Gene interaction matrix.


All entities (e.g., drugs, genes, diseases and side-effects) are organized in the same order across all files (e.g., DrugIdsCov_index, GenesIdsCov_index).

